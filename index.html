<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />

  <title>DJ Drum Kit</title>
  <meta name="description" content="DJ Drum Kit — motion-triggered drums with realtime calling." />
  <meta name="theme-color" content="#0b0c10" />

  <!-- PWA -->
  <link rel="manifest" href="/manifest.json" />
  <link rel="icon" type="image/png" sizes="192x192" href="/icon-192.png" />
  <link rel="icon" type="image/png" sizes="512x512" href="/icon-512.png" />
  <link rel="apple-touch-icon" href="/icon-192.png" />

  <!-- Styles -->
  <link rel="stylesheet" href="/styles.css" />

  <!-- TensorFlow + COCO-SSD -->
  <script src="https://cdn.jsdelivr.net/npm/@tensorflow/tfjs@4.10.0/dist/tf.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/@tensorflow-models/coco-ssd@2.2.2"></script>
</head>
<body>

  <!-- ===== INTRO SCREEN / ONBOARDING ===== -->
  <div id="onboard" class="onboard" role="dialog" aria-modal="true">
    <div class="sheet full-screen">
      <h1>Welcome to DJ Drum Kit</h1>
      <p>This app uses your <strong>camera</strong> and <strong>microphone</strong> so you can:<br>
        • Take a photo of real objects<br>
        • Assign drum sounds<br>
        • Play by motion detection<br>
        • Call a friend to jam live</p>
      <p>All features happen on your device. No data is sent or saved.</p>

      <div class="row" style="gap:12px; justify-content:flex-end;">
        <button id="btnGrant" class="primary">Grant Permissions</button>
        <button id="btnWhy">Why This is Needed</button>
        <button id="btnDismiss">Dismiss</button>
      </div>
    </div>
  </div>

  <!-- ===== MAIN CAMERA VIEW ===== -->
  <main id="mainScreen" class="hidden">
    <video id="camera" autoplay playsinline muted></video>
    <button id="btnCapture" class="floating-button">📸 Snap</button>
  </main>

  <!-- ===== DETECTION + LABELING ===== -->
  <section id="labelingScreen" class="hidden">
    <h2>Label Detected Items</h2>
    <div id="detectedGrid" class="label-grid"></div>
    <button id="btnContinueToPlay" class="primary">Continue</button>
  </section>

  <!-- ===== PLAYGROUND: DRUMMING ===== -->
  <section id="playScreen" class="hidden">
    <video id="cameraLive" autoplay muted playsinline></video>
    <div id="dupeArea" class="dupe-area" aria-label="Duplicated drum pads"></div>

    <div class="floating-controls">
      <button id="btnRecordLoop">● Record Loop</button>
      <button id="btnAddLoop">➕ Add Loop</button>
      <button id="btnRecordMedia">⏺ Record Media</button>
      <button id="btnCall">📞 Call</button>
    </div>
  </section>

  <!-- ===== CALLING / MESSENGER-STYLE VIDEO CHAT ===== -->
  <section id="callScreen" class="hidden">
    <video id="cameraCall" autoplay muted playsinline></video>
    <video id="remoteVideo" class="pip" autoplay playsinline></video>

    <div class="floating-controls">
      <button id="btnCallNow">📞 Call</button>
      <button id="btnAnswer">✅ Answer</button>
      <button id="btnHangup">❌ Hang Up</button>
    </div>
  </section>

  <!-- ===== FOOTER ===== -->
  <footer>
    <div>© <span id="year"></span> Umbrella Systems</div>
    <div id="diag" class="mono"></div>
  </footer>

  <!-- ===== APP ENTRY ===== -->
  <script type="module" src="/src/app.js"></script>
</body>
</html>
